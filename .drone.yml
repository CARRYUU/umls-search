kind: pipeline
type: docker
name: umls-search-server

steps:
  - name: build
    image: bluebetweenneck/umlssearch
    settings:
      mmlite_data_path: "/home/ncuuser/ci/metamaplite"
      mmlite_jar_path: "/home/ncuuser/ci/metamaplite-3.6.2rc8-standalone.jar"

  - name: run
    image: eclipse-temurin:17
    ports:
      - 1313
    environment:
      SERVER_PORT: 1313
      DB_HOST: localhost
      DB_NAME:
        from_secret: database_name
      DB_USERNAME:
        from_secret: database_username
      DB_PASSWORD:
        from_secret: database_password
    commands:
      - java -jar server/target/umls-search-0.1.0.jar

trigger:
  branch:
  - production
