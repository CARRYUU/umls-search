# Usage

可以先裝虛擬環境，沒有也沒關係。

將`MRCONSO.RRF`、`MRDEF.RRF`、`MRREL.RRF`、`MRSTY.RRF`放進`umls/data`資料夾下。

```sh
pip install pandas # 安裝處理資料的套件
python umls/scripts/rrf_to_csv.py # 執行
```

輸出完成的csv會在`umls/data`底下。

# Tables

參考此文件: https://www.ncbi.nlm.nih.gov/books/NBK9685/

所需的檔案如下:

| File        | Description                | Columns Needed  | Metadata                                                                                    |
| ----------- | -------------------------- | --------------- | ------------------------------------------------------------------------------------------- |
| MRCONSO.RRF | Concept Names              | CUI, STR        | CUI: Concept Unique Identifier, STR: String                                                 |
| MRDEF.RRF   | Concept Definitions        | CUI, DEF        | CUI: Concept Unique Identifier, DEF: Definition                                             |
| MRHIER.RRF  | Hierarchical Relationships | CUI, PAUI, AUI  | CUI: Concept Unique Identifier, PAUI: Parent Unique Identifier, AUI: Atom Unique Identifier |
| MRREL.RRF   | Relationships              | CUI1, CUI2, REL | CUI1: Concept 1 Unique Identifier, CUI2: Concept 2 Unique Identifier, REL: Relationship     |

> TO 內部人員: 因為檔案過大請至此處[下載](https://drive.google.com/file/d/1mAvw1aqZDLs4j684cSZjdOnypHtp55py/view?usp=share_link)

## 每個檔案的 Table

### MRCONSO.RRF

> [Table 1](https://www.ncbi.nlm.nih.gov/books/NBK9685/table/ch03.T.concept_names_and_sources_file_mr/?report=objectonly)

| Column   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CUI      | Unique identifier for concept                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| LAT      | Language of term                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| TS       | Term status                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| LUI      | Unique identifier for term                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| STT      | String type                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| SUI      | Unique identifier for string                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ISPREF   | Atom status - preferred (Y) or not (N) for this string within this concept                                                                                                                                                                                                                                                                                                                                                                                                        |
| AUI      | Unique identifier for atom - variable length field, 8 or 9 characters                                                                                                                                                                                                                                                                                                                                                                                                             |
| SAUI     | Source asserted atom identifier [optional]                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| SCUI     | Source asserted concept identifier [optional]                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| SDUI     | Source asserted descriptor identifier [optional]                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| SAB      | Abbreviated source name (SAB). Maximum field length is 20 alphanumeric characters. Two source abbreviations are assigned: Root Source Abbreviation (RSAB) — short form, no version information, for example, AI/RHEUM, 1993, has an RSAB of "AIR" Versioned Source Abbreviation (VSAB) — includes version information, for example, AI/RHEUM, 1993, has an VSAB of "AIR93" Official source names, RSABs, and VSABs are included on the UMLS Source Vocabulary Documentation page. |
| TTY      | Abbreviation for term type in source vocabulary, for example PN (Metathesaurus Preferred Name) or CD (Clinical Drug). Possible values are listed on the Abbreviations Used in Data Elements page.                                                                                                                                                                                                                                                                                 |
| CODE     | Most useful source asserted identifier (if the source vocabulary has more than one identifier), or a Metathesaurus-generated source entry identifier (if the source vocabulary has none)                                                                                                                                                                                                                                                                                          |
| STR      | String                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| SRL      | Source restriction level                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| SUPPRESS | Suppressible flag. Values = O, E, Y, or N                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| CVF      | Content View Flag. Bit field used to flag rows included in Content View. This field is a varchar field to maximize the number of bits available for use.                                                                                                                                                                                                                                                                                                                          |

flag values:

- O: All obsolete content, whether they are obsolesced by the source or by NLM. These will include all atoms having obsolete TTYs, and other atoms becoming obsolete that have not acquired an obsolete TTY (e.g. RxNorm SCDs no longer associated with current drugs, LNC atoms derived from obsolete LNC concepts).
- E: Non-obsolete content marked suppressible by an editor. These do not have a suppressible SAB/TTY combination.
- Y: Non-obsolete content deemed suppressible during inversion. These can be determined by a specific SAB/TTY combination explicitly listed in MRRANK.
- N: None of the above
  Default suppressibility as determined by NLM (i.e., no changes at the Suppressibility tab in MetamorphoSys) should be used by most users, but may not be suitable in some specialized applications. See the MetamorphoSys Help page for information on how to change the SAB/TTY suppressibility to suit your requirements. NLM strongly recommends that users not alter editor-assigned suppressibility, and MetamorphoSys cannot be used for this purpose.

### MRDEF.RRF

> [Table 3](https://www.ncbi.nlm.nih.gov/books/NBK9685/table/ch03.T.definitions_file_mrdef_rrf/?report=objectonly)

| Column   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CUI      | Unique identifier for concept                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| AUI      | Unique identifier for atom - variable length field, 8 or 9 characters                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ATUI     | Unique identifier for attribute                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| SATUI    | Source asserted attribute identifier [optional-present if it exists]                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SAB      | Abbreviated source name (SAB) of the source of the definition. Maximum field length is 20 alphanumeric characters. Two source abbreviations are assigned: Root Source Abbreviation (RSAB) — short form, no version information, for example, AI/RHEUM, 1993, has an RSAB of "AIR" Versioned Source Abbreviation (VSAB) — includes version information, for example, AI/RHEUM, 1993, has an VSAB of "AIR93" Official source names, RSABs, and VSABs are included on the UMLS Source Vocabulary Documentation page. |
| DEF      | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| SUPPRESS | Suppressible flag. Values = O, E, Y, or N. Reflects the suppressible status of the attribute; not yet in use. See also SUPPRESS in MRCONSO.RRF, MRREL.RRF, and MRSAT.RRF.                                                                                                                                                                                                                                                                                                                                         |
| CVF      | Content View Flag. Bit field used to flag rows included in Content View. This field is a varchar field to maximize the number of bits available for use.                                                                                                                                                                                                                                                                                                                                                          |

### MRHIER.RRF

> [Table 7](https://www.ncbi.nlm.nih.gov/books/NBK9685/table/ch03.T.computable_hierarchies_file_mrhie/?report=objectonly)

| Column | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CUI    | Unique identifier of concept                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| AUI    | Unique identifier of atom - variable length field, 8 or 9 characters                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| CXN    | Context number (e.g., 1, 2, 3)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| PAUI   | Unique identifier of atom's immediate parent within this context                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| SAB    | Abbreviated source name (SAB) of the source of atom (and therefore of hierarchical context). Maximum field length is 20 alphanumeric characters. Two source abbreviations are assigned: Root Source Abbreviation (RSAB) — short form, no version information, for example, AI/RHEUM, 1993, has an RSAB of "AIR" Versioned Source Abbreviation (VSAB) — includes version information, for example, AI/RHEUM, 1993, has an VSAB of "AIR93" Official source names, RSABs, and VSABs are included on the UMLS Source Vocabulary Documentation page. |
| RELA   | Relationship of atom to its immediate parent                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PTR    | Path to the top or root of the hierarchical context from this atom, represented as a list of AUIs, separated by periods (.) The first one in the list is top of the hierarchy; the last one in the list is the immediate parent of the atom, which also appears as the value of PAUI.                                                                                                                                                                                                                                                           |
| HCD    | Source asserted hierarchical number or code for this atom in this context; this field is only populated when it is different from the code (unique identifier or code for the string in that source).                                                                                                                                                                                                                                                                                                                                           |
| CVF    | Content View Flag. Bit field used to flag rows included in Content View. This field is a varchar field to maximize the number of bits available for use                                                                                                                                                                                                                                                                                                                                                                                         |

### MRREL.RRF

> [Table 5](https://www.ncbi.nlm.nih.gov/books/NBK9685/table/ch03.T.related_concepts_file_mrrel_rrf/?report=objectonly)

Here is the information in a markdown table:

| Column   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CUI1     | Unique identifier of first concept                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| AUI1     | Unique identifier of first atom                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| STYPE1   | The name of the column in MRCONSO.RRF that contains the identifier used for the first element in the relationship, i.e. AUI, CODE, CUI, SCUI, SDUI                                                                                                                                                                                                                                                                                                                                                        |
| REL      | Relationship of second concept or atom to first concept or atom                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| CUI2     | Unique identifier of second concept                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| AUI2     | Unique identifier of second atom                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| STYPE2   | The name of the column in MRCONSO.RRF that contains the identifier used for the second element in the relationship, i.e. AUI, CODE, CUI, SCUI, SDUI                                                                                                                                                                                                                                                                                                                                                       |
| RELA     | Additional (more specific) relationship label (optional)                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| RUI      | Unique identifier of relationship                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| SRUI     | Source asserted relationship identifier, if present                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| SAB      | Abbreviated source name of the source of relationship. Maximum field length is 20 alphanumeric characters. Two source abbreviations are assigned: Root Source Abbreviation (RSAB) — short form, no version information, for example, AI/RHEUM, 1993, has an RSAB of "AIR" Versioned Source Abbreviation (VSAB) — includes version information, for example, AI/RHEUM, 1993, has an VSAB of "AIR93" Official source names, RSABs, and VSABs are included on the UMLS Source Vocabulary Documentation page. |
| SL       | Source of relationship labels                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| RG       | Relationship group. Used to indicate that a set of relationships should be looked at in conjunction                                                                                                                                                                                                                                                                                                                                                                                                       |
| DIR      | Source asserted directionality flag. Y indicates that this is the direction of the relationship in its source; N indicates that it is not; a blank indicates that it is not important or has not yet been determined                                                                                                                                                                                                                                                                                      |
| SUPPRESS | Suppressible flag. Reflects the suppressible status of the relationship. See also SUPPRESS in MRCONSO.RRF, MRDEF.RRF, and MRSAT.RRF                                                                                                                                                                                                                                                                                                                                                                       |
| CVF      | Content View Flag. Bit field used to flag rows included in Content View. This field is a varchar field to maximize the number of bits available for use                                                                                                                                                                                                                                                                                                                                                   |
